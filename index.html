<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title></title>
	<style>
		item{position:relative; display: block;border-bottom: 1px solid #ededed;} item:last-child { border-bottom: none; } i { text-align: center; width: 40px; /* auto, since non-WebKit browsers doesn't support input styling */ height: 40px; position: absolute; top: 0; bottom: 0; margin: auto 0; border: none; /* Mobile Safari */ -webkit-appearance: none; appearance: none; } i:after { content: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="-10 -18 100 135"><circle cx="50" cy="50" r="50" fill="none" stroke="#ededed" stroke-width="3"/></svg>'); } i.checked:after { content: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="-10 -18 100 135"><circle cx="50" cy="50" r="50" fill="none" stroke="#bddad5" stroke-width="3"/><path fill="#5dc2af" d="M72 25L42 71 27 56l-4 4 20 20 34-52z"/></svg>'); } i.checked+.view label{color: #d9d9d9; text-decoration: line-through;} label { white-space: pre-line; word-break: break-all; padding: 15px 60px 15px 15px; margin-left: 45px; display: block; line-height: 1.2; transition: color 0.4s; } label br{display:none;} label *{display:inline;} .completed label { color: #d9d9d9; text-decoration: line-through; } .destroy { display: none; position: absolute; top: 0; right: 10px; bottom: 0; width: 40px; height: 40px; margin: auto 0; font-size: 30px; color: #cc9a9a; margin-bottom: 11px; transition: color 0.2s ease-out; } .destroy:hover { color: #af5b5e; } .destroy:after { content: '×'; } item:hover .destroy { display: block; } .edit { display: none; } .editing:last-child { margin-bottom: -1px; }
		html, body { margin: 0; padding: 0; } button { margin: 0; padding: 0; border: 0; background: none; font-size: 100%; vertical-align: baseline; font-family: inherit; font-weight: inherit; color: inherit; -webkit-appearance: none; appearance: none; -webkit-font-smoothing: antialiased; -moz-font-smoothing: antialiased; font-smoothing: antialiased; } body { font: 14px 'Helvetica Neue', Helvetica, Arial, sans-serif; line-height: 1.4em; background: #f5f5f5; color: #4d4d4d; min-width: 230px; max-width: 550px; margin: 0 auto; -webkit-font-smoothing: antialiased; -moz-font-smoothing: antialiased; font-smoothing: antialiased; font-weight: 300; } button, input[type="checkbox"] { outline: none; } .hidden { display: none; } .todoapp { background: #fff; margin: 130px 0 40px 0; position: relative; box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.2), 0 25px 50px 0 rgba(0, 0, 0, 0.1); } .todoapp input::-webkit-input-placeholder { font-style: italic; font-weight: 300; color: #e6e6e6; } .todoapp input::-moz-placeholder { font-style: italic; font-weight: 300; color: #e6e6e6; } .todoapp input::input-placeholder { font-style: italic; font-weight: 300; color: #e6e6e6; } .active .todo-list todo_item i.checked{display:none;} .active .todo-list todo_item i.checked+.view{display:none;} .completed .todo-list todo_item i, .completed .todo-list todo_item .view{display:none;} .completed .todo-list todo_item i.checked, .completed .todo-list todo_item i.checked + .view{display:block;} .filters li:first-child a, .completed .filters li:first-child+li+li a, .active .filters li:first-child+li a{ border-color: rgba(175, 47, 47, 0.2); } .completed .filters li:first-child a, .active .filters li:first-child a, .filters li a{border-color:#fff;} .todoapp h1 { position: absolute; top: -155px; width: 100%; font-size: 100px; font-weight: 100; text-align: center; color: rgba(175, 47, 47, 0.15); -webkit-text-rendering: optimizeLegibility; -moz-text-rendering: optimizeLegibility; text-rendering: optimizeLegibility; } .new-todo, .edit { position: relative; margin: 0; width: 100%; font-size: 24px; font-family: inherit; font-weight: inherit; line-height: 1.4em; border: 0; outline: none; color: inherit; padding: 6px; border: 1px solid #999; box-shadow: inset 0 -1px 5px 0 rgba(0, 0, 0, 0.2); box-sizing: border-box; -webkit-font-smoothing: antialiased; -moz-font-smoothing: antialiased; font-smoothing: antialiased; } .new-todo { padding: 16px 16px 16px 60px; border: none; background: rgba(0, 0, 0, 0.003); box-shadow: inset 0 -2px 1px rgba(0,0,0,0.03); } .main { position: relative; z-index: 2; border-top: 1px solid #e6e6e6; } label[for='toggle-all'] { display: none; } .toggle-all { position: absolute; top: -55px; left: -12px; width: 60px; height: 34px; text-align: center; border: none; /* Mobile Safari */ } .toggle-all:before { content: '❯'; font-size: 22px; color: #e6e6e6; padding: 10px 27px 10px 27px; } .toggle-all:checked:before { color: #737373; } .todo-list { margin: 0; padding: 0; list-style: none; } .todo-list todo_item { display:block; position: relative; font-size: 24px; } .footer { color: #777; padding: 10px 15px; height: 20px; text-align: center; border-top: 1px solid #e6e6e6; } .footer:before { content: ''; position: absolute; right: 0; bottom: 0; left: 0; height: 50px; overflow: hidden; box-shadow: 0 1px 1px rgba(0, 0, 0, 0.2), 0 8px 0 -3px #f6f6f6, 0 9px 1px -3px rgba(0, 0, 0, 0.2), 0 16px 0 -6px #f6f6f6, 0 17px 2px -6px rgba(0, 0, 0, 0.2); } .todo-count { float: left; text-align: left; } .todo-count strong { font-weight: 300; } .filters { margin: 0; padding: 0; list-style: none; position: absolute; right: 0; left: 0; } .filters li { display: inline; } .filters li a { color: inherit; margin: 3px; padding: 3px 7px; text-decoration: none; border: 1px solid transparent; border-radius: 3px; } .filters li a.selected, .filters li a:hover { border-color: rgba(175, 47, 47, 0.1); } .filters li a.selected { border-color: rgba(175, 47, 47, 0.2); } .clear-completed, html .clear-completed:active { float: right; position: relative; line-height: 20px; text-decoration: none; cursor: pointer; position: relative; } .clear-completed:hover { text-decoration: underline; } .info { margin: 65px auto 0; color: #bfbfbf; font-size: 10px; text-shadow: 0 1px 0 rgba(255, 255, 255, 0.5); text-align: center; } .info p { line-height: 1; } .info a { color: inherit; text-decoration: none; font-weight: 400; } .info a:hover { text-decoration: underline; } /* Hack to remove background from Mobile Safari. Can't use it globally since it destroys checkboxes in Firefox */ @media screen and (-webkit-min-device-pixel-ratio:0) { .toggle-all, .todo-list todo_item .toggle { background: none; } .todo-list todo_item .toggle { height: 40px; } .toggle-all { -webkit-transform: rotate(90deg); transform: rotate(90deg); -webkit-appearance: none; appearance: none; } } @media (max-width: 430px) { .footer { height: 50px; } .filters { bottom: 10px; } }:root{border-bottom: 1px solid #ededed;} :root:last-child { border-bottom: none; } i { text-align: center; width: 40px; /* auto, since non-WebKit browsers doesn't support input styling */ height: 40px; position: absolute; top: 0; bottom: 0; margin: auto 0; border: none; /* Mobile Safari */ -webkit-appearance: none; appearance: none; } i:after { content: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="-10 -18 100 135"><circle cx="50" cy="50" r="50" fill="none" stroke="#ededed" stroke-width="3"/></svg>'); } i.checked:after { content: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="-10 -18 100 135"><circle cx="50" cy="50" r="50" fill="none" stroke="#bddad5" stroke-width="3"/><path fill="#5dc2af" d="M72 25L42 71 27 56l-4 4 20 20 34-52z"/></svg>'); } i.checked+.view label{color: #d9d9d9; text-decoration: line-through;} label { white-space: pre-line; word-break: break-all; padding: 15px 60px 15px 15px; margin-left: 45px; display: block; line-height: 1.2; transition: color 0.4s; } label br{display:none;} label *{display:inline;} .completed label { color: #d9d9d9; text-decoration: line-through; } .destroy { display: none; position: absolute; top: 0; right: 10px; bottom: 0; width: 40px; height: 40px; margin: auto 0; font-size: 30px; color: #cc9a9a; margin-bottom: -6px; transition: color 0.2s ease-out; } .destroy:hover { color: #af5b5e; } .destroy:after { content: '×'; } :root:hover .destroy { display: block; } .edit { display: none; } .editing:last-child { margin-bottom: -1px; }
	</style>
	<script src="./dist/understore.js"></script>
</head>
<body>
	
	<div class="todoapp">
  		<div class="header">
  			<h1>todos</h1>
  			<form action="javascript:;" class="todo_input"></form>
  		</div>
  		<div class="main">
  			<input class="toggle-all" type="checkbox">
  			<div class="todo-list"></div>
  		</div>
  		<div class="footer">
  			<span class="todo-count"></span>
  			<ul class="filters">
  				<li>
  					<a href="#/all">All</a>
  				</li>
  				<li>
  					<a class="" href="#/active">Active</a>
  				</li>
  				<li>
  					<a class="" href="#/completed">Completed</a>
  				</li> 
  			</ul><button class="clear-completed" onclick="clearTodo()">Clear completed</button>
  		</div>
  	</div>
	<script>
// Code goes here
var todoItemTpl = '<item>\
	<i class="{ this.complete }" @click="checked" ></i>\
	<div class="view ">\
		<label @keyup="submit" @dblclick="setMode" >{this.title}</label> <a @click="remove" class="destroy"></a>\
	</div></item>';

var todoStatusTpl = '<test><strong>{ this.count }</strong> item left</test>';

var inputTpl = '<asd><input type="text" value="{ this.title }" @paste="write" @keyup="write" class="new-todo" placeholder="What needs to be done?" /></asd>';

function clearTodo(){
	var id = "todo_item";
	var todo_index = eval("["+_.getCookie(id)+"]");

	for(var i = 0, len = todo_index.length; i < len; i++){
		var todo_item = _.getItem({id : id, idx : todo_index[i]});
		if(todo_item.data.complete == "checked"){
			_.removeItem({id : id, idx : todo_index[i]});
		}
	}
}

var setTodo = function(event, element, option){
	if(event.which == 13){
		_.setItem({
			id :  option.id,
			idx : option.idx,
			data : {title:element.textContent}
		});
		element.removeAttribute("contenteditable");
	}else if(event.which == 27){
		var item = _.getItem({
			id :  option.id,
			idx : option.idx
		});
		element.textContent = item.data.title;
		element.removeAttribute("contenteditable");
	}
};

var setMode = function(event, element, option){
	console.log(element);
	element.setAttribute("contenteditable", true);
	element.focus();
};

var newTodo = function(event, element, option){
	if((event.keyCode == 13 || event.which == 13) && element.value.length > 0){

		_.addItem({
		  id :  "todo_item",
		  data : {title:element.value , complete : ""}
		});
		
		setTimeout(function(){
			_.setItem({
				id : "todo_input",
				data : {title:""}
			});
		}, 15);

	}else{
		var t = 0;
		event.type == "paste" ? t = 10 : "";
		setTimeout(function(element){
			_.setItem({
				id : "todo_input",
				data : {title : element.value}
			});
		}, 100, element);
	}
};

var route = function(e){
	var path = window.location.hash;
	path = path.replace("#/", ""); 
	document.body.className = path;
};

var removeTodo = function(event, element, option){
	_.removeItem({
		id : option.id,
		idx : option.idx
	});
};

var completeTodo = function(event, element, option){
	var obj = {
		id : option.id,
		idx : option.idx
	};
	var item = _.getItem(obj);

	element.className == "" ? item.data.complete = "checked" : item.data.complete = "";

	obj.data = item.data;
	_.setItem(obj);
};


_.addItem({
	id : "todo_count",
	template : todoStatusTpl,
	target : document.querySelector(".todo-count"),
	data : {count : 0},
	sync : true,
	events : {
		write : newTodo
	}
});

_.addItem({
	id : "todo_input",
	template : inputTpl,
	target : document.querySelector(".todo_input"),
	sync : true,
	data : {title : ""},
	events : {
		write : newTodo
	}
});	

_.addItem({
	id : "todo_item",
	template : todoItemTpl,
	target : document.querySelector(".todo-list"),
	sync : true,
	css : "/todo_item.css",
	events : {
		checked : completeTodo,
		remove : removeTodo,
		submit : setTodo,
		setMode : setMode
	}
});


route();
// window.onhashchange = hashchange;
		
	</script>
</body>
</html>